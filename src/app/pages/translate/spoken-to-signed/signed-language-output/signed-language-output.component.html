<div *ngIf="videoUrl; else poseViewer">
  <video
    [src]="safeVideoUrl"
    autoplay
    loop
    muted
    playsinline
    height="100%"
    width="100%"
    (loadedmetadata)="triggerDownload()"
    (error)="onVideoError($event)"
    (click)="playVideoIfPaused($event)"></video>
</div>

<ng-template #poseViewer>
  <div *ngIf="pose$ | async as pose">
    <div *ngIf="poseViewerSetting$ | async as poseViewerSetting">
      <ng-container [ngSwitch]="poseViewerSetting">
        <app-skeleton-pose-viewer *ngSwitchCase="'pose'" [src]="pose"></app-skeleton-pose-viewer>
        <app-human-pose-viewer *ngSwitchCase="'person'" [src]="pose"></app-human-pose-viewer>
        <app-avatar-pose-viewer *ngSwitchCase="'avatar'" [src]="pose"></app-avatar-pose-viewer>
      </ng-container>
    </div>
    <div class="actions-row" *ngIf="videoUrl">
      <ion-button
        class="circle-icon"
        fill="clear"
        shape="round"
        color="dark"
        (click)="downloadTranslation()"
        [attr.aria-label]="'translate.spoken-to-signed.actions.download' | transloco"
        [matTooltip]="'translate.spoken-to-signed.actions.download' | transloco"
        [matTooltipPosition]="'above'">
        <ion-icon name="download-outline" slot="icon-only"></ion-icon>
      </ion-button>
      <ion-button
        *ngIf="isSharingSupported"
        class="circle-icon"
        fill="clear"
        shape="round"
        color="dark"
        (click)="shareTranslation()"
        [attr.aria-label]="'translate.spoken-to-signed.actions.share' | transloco"
        [matTooltip]="'translate.spoken-to-signed.actions.share' | transloco"
        [matTooltipPosition]="'above'">
        <ion-icon ios="share-outline" md="share-social-outline" slot="icon-only"></ion-icon>
      </ion-button>
      <ion-button [disabled]="true" class="circle-icon" fill="clear" shape="round">
        <ion-spinner name="crescent" color="dark"></ion-spinner>
      </ion-button>
      <app-viewer-selector></app-viewer-selector>
    </div>
  </div>
</ng-template>
